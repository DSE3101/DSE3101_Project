---
title: "Frontend RMD"
author: "ZH, Nic, FT, Lily"
date: "2024-02-29"
output: html_document
---

## Initialisation

# Load Packages
```{r setup, include=FALSE}
library(shiny)
library(tidyverse)
library(ggthemes)
```

## Breakdown of Frontend visuals
# Main
Main visuals will be a time series graph.


# Components
1. Sliders to select training period
2. Drop down component for historical shock
  Covid Recession, Lehmann Brothers, The Covid Rebound, Tech Boom


### Codes
We will build this project like lego pieces. so each component will be build as an object, and then will be put in the main ui. <br>
We will begin with the components

## Components
# Slider Component
Slider will allow users to select the training data. Will need to format the data by quarters i think
```{r}
slider = sliderInput("dateRange",
                "Select Training Date:",
                min = as.Date("1960-01-01"),
                max = as.Date("2023-12-31"),
                value = c(as.Date("1980-01-01"), as.Date("2020-01-01")),
                timeFormat = "%Y-%m-%d")
```

# Dropdown 
```{r}
dropdown <- selectInput("dropdownMenu", 
              "Choose an Option:", 
              choices = c("Covid-19 Recession" = "opt1", 
                          "Lehmann Brother's Crash" = "opt2", 
                          "Great Financial Crisis" = "opt3")
)
```


#Texts
```{r}
bodyText <- function(text){
  tags$p(text, class = "bodyText")
}
```


## Main
basically the ui page, where everything comes in as one
```{r}
ui <- fluidPage(
  includeCSS("styles.css"),
  div(class = "main",
      titlePanel("Time Series Analysis"),
      mainPanel(
        bodyText("Test Text"),
        div(class = "graphBorder",
            plotOutput("timeSeriesGraph")),
        slider,
        dropdown),
      titlePanel("Real Time vs Vintage Data")
  )
)
```


## Server code
Server code is where the data comes in, I will connect this to the main dataset in time and adjust accordingly. But for now, I will use a dummy data set.

# Link the source
Only activate this when the time series code is ready
```{r}
#source("Time_Series.R")
```


# Creating a dummy dataset first.
```{r}
set.seed(123)
dummyData <- data.frame(
    date = seq(as.Date("1960-01-01"), as.Date("2023-12-31"), by = "month"),
    value = cumsum(runif(768, min = -10, max = 10)) # Random walk data
  )
```

# Main server code
```{r}
server <- function(input, output) {
  output$timeSeriesGraph <- renderPlot({
    # Ensure highlightedData uses the filter based on selected date range
    highlightedData <- dummyData %>%
      filter(date >= input$dateRange[1], date <= input$dateRange[2])
    
    # Start plotting using ggplot2 with dummyData as the base data
    plot <- ggplot() +
      geom_line(data = dummyData, aes(x = date, y = value)) + 
      geom_line(data = highlightedData, aes(x = date, y = value), color = "red", size = 1.5) + 
      #Colour the user selected training data red
      labs(title = "Dummy Time Series Graph", x = "Date", y = "Value") +
      theme_economist_white()
    plot
  })
}
```

Run the plot
```{r, include = FALSE}
shinyApp(ui,server)
```
